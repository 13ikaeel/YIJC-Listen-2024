<!DOCTYPE html>
<html lang='en'>
<head>
	<title>YIJC Listen 2024</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="../static/styles.css">
	<link rel="icon" type="image/png" href="../static/Images/logo.png">

	<!--Main font(lora)-->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
	
	<!--Secondary font()-->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
	
	<!--Icons from boxicons-->
	<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>


<!--********************************************************************************************************************************************************************************************************-->
<!--********************************************************************************************************************************************************************************************************-->
<!--********************************************************************************************************************************************************************************************************-->
<!--********************************************************************************************************************************************************************************************************-->


<body>

	<!-- Sidebar with image -->
	<nav class="poster w3-sidebar w3-hide-medium w3-hide-small" style="width:40%">
		<div class="poster-img"></div>
	</nav>
	
	<a href="../" class="w3-button w3-top w3-xxlarge  w3-hover-text-black" style="width:auto;right:0;"><i class='bx bx-arrow-back'></i></a>


	<!-- Page Content -->
	<div class="w3-main w3-padding-large" style="margin-left:40%">


		<!-- Header -->
		<header class="w3-container w3-center" style="padding:80px 16px 40px 16px" id="home">

			<img src='../static/Images/mc20.png' class="w3-image w3-hide-large w3-hide-small w3-round" style="display:block;width:60%;margin:auto;">
			<img src='../static/Images/mc20.png' class="w3-image w3-hide-large w3-hide-medium w3-round" width="1000" height="1333">

			<form action="{{url_for('resend_ticket_success')}}" method="POST">
				<h3 class="w3-main"><b>Resend Ticket</b></h3>
				<input id="emailbox" name="email" autocomplete="email"  type="email" placeholder=" Enter Your Icons Email" required>
				<div id = "buttonContainer">
					<button id="emailbutton">Resend Ticket</button>
				</div>
			</form>

			
			<div class="flashes">
				{% for message in get_flashed_messages() %}
					<p>{{message}}</p>
				{% endfor %}
			</div>
			
		</header>


	</div>

	
		
		
	<script>
	// Open and close sidebar
	function openNav() {
		document.getElementById("mySidebar").style.width = "100%";
		document.getElementById("mySidebar").style.display = "block";
	}

	function closeNav() {
		document.getElementById("mySidebar").style.display = "none";
	}
	let counter = 0;
	const input = document.querySelector('#emailbox');
	const email = input.value;
	const regex = /[a-zA-Z]@students.edu.sg/;
	let isPageUnloading = false;
	const btn = document.getElementById("emailbutton");
	const container = document.getElementById("buttonContainer");
	
	const valid = (str)  => {
		const regex  = /[a-zA-Z]@students\.edu\.sg/;
		return regex.test(str)
	}
	const disable = () => {
		const email = input.value;
		if (valid(email)){
			console.log("valid email")
			counter += 1;
			if (counter > 1){
				btn.style.cursor = "not-allowed";
   				btn.disabled = true;
    			btn.innerText = "Submitting...";
    			btn.style.backgroundColor = "#483d8b";
			}
    		btn.style.cursor = "not-allowed";
    		btn.innerText = "Submitting...";
    		btn.style.backgroundColor = "#E6E6FA";
			isPageUnloading = true;
	}
}
	btn.addEventListener('click', disable);	

	window.addEventListener('pageshow', function(event) {
  		if (event.persisted) {
			container.innerHTML = `
			<button id="signin-button" type="submit">Resend Ticket</button>`
  		}
	});
	</script>

</body>
</html>
